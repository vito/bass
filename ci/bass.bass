(def git (load (*dir*/git)))

(def repo
  (git:resource "https://github.com/vito/bass"))

(defn build [src os arch]
  (let [output (string->fs-path (str "bass-" os "-" arch))]
    (path
      (from "golang"
        (cd src
          (-> ($ go build -o (subpath ../ output) ./cmd/bass)
              (with-env {:GOOS os :GOARCH arch :CGO_ENABLED "0"}))))
      output)))
